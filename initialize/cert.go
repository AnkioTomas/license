package initialize

import (
	"fmt"
	"license/config"
	"license/logger"
	"os"
)

const gitlabPrivateKey = "-----BEGIN RSA PRIVATE KEY-----\nMIIEpQIBAAKCAQEAtPGu+l7+6NPtSPEArqDTQG6AO1QlTlOoLZxi5fqZGiMZRktv\nTPCrnBJoHoVDFAZ9OfISOYPWPqJ9rl//q6HPHNJ/uxCccG4vqPo8frqFS7N9/RLZ\nZdPY4BIeJe2ivR0lDgbC35yxBwsXOdA8mWu/g0Y6Wui6L42wdbrXAS6cRl6tamAR\n8fh4n8lGTHjEk8W5f56behwrvZgq32nOPK0wnGUxrPXu8XyRcx7QBYH+1EQHstjO\nsiIiPTvI9VkMIBl0XfmgbR5f2UDs5wl3nVRdvKSnTiWOgd/wbmhZhq9t+AxiC+Wc\nUnJTSuZdHsr7MvOoGUWrkSEc+gouEGVoFSymkQIDAQABAoIBAQCUy65Nm7LZufUG\nJ5GdCQnPkU8H+tFW0Pqaz2CQqHwgfz54jO3xAnTMumI+vu2DWTa/YO5Vt7GF/k+G\nBtGTzVMo6304Upei6SluNqFqwW197BOt+kMmNojA8oUyQXGzPHVNTIgSJKN7HEa0\nNyauL2nkxOqV+Y2qL0Ut+0B1a2P9hNntxx48vaR7le7gngG4f21o5qwsxcOg4lmb\nO02KCGugMJDxzYw4VbxBMfbWC7QwtmPHCjqZRQPJFwZP1EXo5g9tZSrRXHntcPEx\nVSCTlnDI+G3s71JvVAKE7i2hZAjN3zwe1+6FfJnESvcjnyh3TNxEtNNP40vM0LPS\noyH1USIBAoGBANluGaILWZsQYsT8Bs+3Qq5tcRJga4wBh/tjBGyCNr8uvuqGtrMk\nvVI8LWGTU4/Nefd+tJlOLs9IiJq57T3m9mQ5Mn1Vi7byRCy6wQqjZnSJ+TupJ3ox\nTm6Tsq0ciAQwoS0HqEd6LoHmczcG8dl7nDyRsUsAe9QFtuTz8X0Kk8uxAoGBANUK\nr9fKyQWi2Ha/TgUdLzyaopfcmTfSauRfrVG0WqpyPfRVXvWylVt20Ac4a/ThDSSD\nZwfaZIPi/gRw4tTVp5c9mDgDlTWQcKzWq1zASUEtpc5ppwRMgngPTz5Hl+tuGzDY\ndkAy2YlsXpyhZGapl84/1TULpKoIYgIOhoufeKDhAoGAUOolReWdahR1/UKhMknL\n2efGjYUuYMLtHQNjURJAV3OI/vQ1J4PDpMfaR5axITHhctZHVUoAJ4mhtJr+i+vY\nw8F5ZaUhQmr0LgUt88yNQ09ZXfd8Rn/05Te35a5Ze92xDXXtDPSOPC9Lry25cSsM\nIIpDhVrfui6KOrgBpXv7NnECgYEAoGWBatjUbJfkndL+rL8CV4CdNfTyrqKPtA2M\n8lz1fiqxFopICnhAFzLnAOir7xyZxongQntc/ici1LkhLtkFassHFfUsm71598dQ\nEW78OERj93p4MrZf7ICqStugN7MYabgvn7opKlwbB5ZDfz/keXZ50YxIl3PkRmQl\nTG3uZkECgYEA09zBvu48DPz3SMNYqlSHYxOHjeyyM2cgZ+PwKbk1o8zlnzUum6zu\nS73COjn/mDXco46Cx3HIo04HKydEL4sWHvhAOsg3BnDq6ZAVbBydFfN9Qa22NOh+\naNW2kiPdY6AODt4w/KNF9F0Yq9C+SKLglPyM4R1jNPJbJB693iNK3Y0=\n-----END RSA PRIVATE KEY-----"
const gitlabPublicKey = "-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtPGu+l7+6NPtSPEArqDT\nQG6AO1QlTlOoLZxi5fqZGiMZRktvTPCrnBJoHoVDFAZ9OfISOYPWPqJ9rl//q6HP\nHNJ/uxCccG4vqPo8frqFS7N9/RLZZdPY4BIeJe2ivR0lDgbC35yxBwsXOdA8mWu/\ng0Y6Wui6L42wdbrXAS6cRl6tamAR8fh4n8lGTHjEk8W5f56behwrvZgq32nOPK0w\nnGUxrPXu8XyRcx7QBYH+1EQHstjOsiIiPTvI9VkMIBl0XfmgbR5f2UDs5wl3nVRd\nvKSnTiWOgd/wbmhZhq9t+AxiC+WcUnJTSuZdHsr7MvOoGUWrkSEc+gouEGVoFSym\nkQIDAQAB\n-----END PUBLIC KEY-----"
const jetbrainsCodeCa = "-----BEGIN CERTIFICATE-----\nMIIFOzCCAyOgAwIBAgIJANJssYOyg3nhMA0GCSqGSIb3DQEBCwUAMBgxFjAUBgNV\nBAMMDUpldFByb2ZpbGUgQ0EwHhcNMTUxMDAyMTEwMDU2WhcNNDUxMDI0MTEwMDU2\nWjAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBMIICIjANBgkqhkiG9w0BAQEFAAOC\nAg8AMIICCgKCAgEA0tQuEA8784NabB1+T2XBhpB+2P1qjewHiSajAV8dfIeWJOYG\ny+ShXiuedj8rL8VCdU+yH7Ux/6IvTcT3nwM/E/3rjJIgLnbZNerFm15Eez+XpWBl\nm5fDBJhEGhPc89Y31GpTzW0vCLmhJ44XwvYPntWxYISUrqeR3zoUQrCEp1C6mXNX\nEpqIGIVbJ6JVa/YI+pwbfuP51o0ZtF2rzvgfPzKtkpYQ7m7KgA8g8ktRXyNrz8bo\niwg7RRPeqs4uL/RK8d2KLpgLqcAB9WDpcEQzPWegbDrFO1F3z4UVNH6hrMfOLGVA\nxoiQhNFhZj6RumBXlPS0rmCOCkUkWrDr3l6Z3spUVgoeea+QdX682j6t7JnakaOw\njzwY777SrZoi9mFFpLVhfb4haq4IWyKSHR3/0BlWXgcgI6w6LXm+V+ZgLVDON52F\nLcxnfftaBJz2yclEwBohq38rYEpb+28+JBvHJYqcZRaldHYLjjmb8XXvf2MyFeXr\nSopYkdzCvzmiEJAewrEbPUaTllogUQmnv7Rv9sZ9jfdJ/cEn8e7GSGjHIbnjV2ZM\nQ9vTpWjvsT/cqatbxzdBo/iEg5i9yohOC9aBfpIHPXFw+fEj7VLvktxZY6qThYXR\nRus1WErPgxDzVpNp+4gXovAYOxsZak5oTV74ynv1aQ93HSndGkKUE/qA/JECAwEA\nAaOBhzCBhDAdBgNVHQ4EFgQUo562SGdCEjZBvW3gubSgUouX8bMwSAYDVR0jBEEw\nP4AUo562SGdCEjZBvW3gubSgUouX8bOhHKQaMBgxFjAUBgNVBAMMDUpldFByb2Zp\nbGUgQ0GCCQDSbLGDsoN54TAMBgNVHRMEBTADAQH/MAsGA1UdDwQEAwIBBjANBgkq\nhkiG9w0BAQsFAAOCAgEAjrPAZ4xC7sNiSSqh69s3KJD3Ti4etaxcrSnD7r9rJYpK\nBMviCKZRKFbLv+iaF5JK5QWuWdlgA37ol7mLeoF7aIA9b60Ag2OpgRICRG79QY7o\nuLviF/yRMqm6yno7NYkGLd61e5Huu+BfT459MWG9RVkG/DY0sGfkyTHJS5xrjBV6\nhjLG0lf3orwqOlqSNRmhvn9sMzwAP3ILLM5VJC5jNF1zAk0jrqKz64vuA8PLJZlL\nS9TZJIYwdesCGfnN2AETvzf3qxLcGTF038zKOHUMnjZuFW1ba/12fDK5GJ4i5y+n\nfDWVZVUDYOPUixEZ1cwzmf9Tx3hR8tRjMWQmHixcNC8XEkVfztID5XeHtDeQ+uPk\nX+jTDXbRb+77BP6n41briXhm57AwUI3TqqJFvoiFyx5JvVWG3ZqlVaeU/U9e0gxn\n8qyR+ZA3BGbtUSDDs8LDnE67URzK+L+q0F2BC758lSPNB2qsJeQ63bYyzf0du3wB\n/gb2+xJijAvscU3KgNpkxfGklvJD/oDUIqZQAnNcHe7QEf8iG2WqaMJIyXZlW3me\n0rn+cgvxHPt6N4EBh5GgNZR4l0eaFEV+fxVsydOQYo1RIyFMXtafFBqQl6DDxujl\nFeU3FZ+Bcp12t7dlM4E0/sS1XdL47CfGVj4Bp+/VbF862HmkAbd7shs7sDQkHbU=\n-----END CERTIFICATE-----"
const jetbrainsServerCa = "-----BEGIN CERTIFICATE-----\nMIIFTDCCAzSgAwIBAgIJAMCrW9HV+hjZMA0GCSqGSIb3DQEBCwUAMB0xGzAZBgNV\nBAMMEkxpY2Vuc2UgU2VydmVycyBDQTAgFw0xNjEwMTIxNDMwNTRaGA8yMTE2MTIy\nNzE0MzA1NFowHTEbMBkGA1UEAwwSTGljZW5zZSBTZXJ2ZXJzIENBMIICIjANBgkq\nhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAoT7LvHj3JKK2pgc5f02z+xEiJDcvlBi6\nfIwrg/504UaMx3xWXAE5CEPelFty+QPRJnTNnSxqKQQmg2s/5tMJpL9lzGwXaV7a\nrrcsEDbzV4el5mIXUnk77Bm/QVv48s63iQqUjVmvjQt9SWG2J7+h6X3ICRvF1sQB\nyeat/cO7tkpz1aXXbvbAws7/3dXLTgAZTAmBXWNEZHVUTcwSg2IziYxL8HRFOH0+\nGMBhHqa0ySmF1UTnTV4atIXrvjpABsoUvGxw+qOO2qnwe6ENEFWFz1a7pryVOHXg\nP+4JyPkI1hdAhAqT2kOKbTHvlXDMUaxAPlriOVw+vaIjIVlNHpBGhqTj1aqfJpLj\nqfDFcuqQSI4O1W5tVPRNFrjr74nDwLDZnOF+oSy4E1/WhL85FfP3IeQAIHdswNMJ\ny+RdkPZCfXzSUhBKRtiM+yjpIn5RBY+8z+9yeGocoxPf7l0or3YF4GUpud202zgy\nY3sJqEsZksB750M0hx+vMMC9GD5nkzm9BykJS25hZOSsRNhX9InPWYYIi6mFm8QA\n2Dnv8wxAwt2tDNgqa0v/N8OxHglPcK/VO9kXrUBtwCIfZigO//N3hqzfRNbTv/ZO\nk9lArqGtcu1hSa78U4fuu7lIHi+u5rgXbB6HMVT3g5GQ1L9xxT1xad76k2EGEi3F\n9B+tSrvru70CAwEAAaOBjDCBiTAdBgNVHQ4EFgQUpsRiEz+uvh6TsQqurtwXMd4J\n8VEwTQYDVR0jBEYwRIAUpsRiEz+uvh6TsQqurtwXMd4J8VGhIaQfMB0xGzAZBgNV\nBAMMEkxpY2Vuc2UgU2VydmVycyBDQYIJAMCrW9HV+hjZMAwGA1UdEwQFMAMBAf8w\nCwYDVR0PBAQDAgEGMA0GCSqGSIb3DQEBCwUAA4ICAQCJ9+GQWvBS3zsgPB+1PCVc\noG6FY87N6nb3ZgNTHrUMNYdo7FDeol2DSB4wh/6rsP9Z4FqVlpGkckB+QHCvqU+d\nrYPe6QWHIb1kE8ftTnwapj/ZaBtF80NWUfYBER/9c6To5moW63O7q6cmKgaGk6zv\nSt2IhwNdTX0Q5cib9ytE4XROeVwPUn6RdU/+AVqSOspSMc1WQxkPVGRF7HPCoGhd\nvqebbYhpahiMWfClEuv1I37gJaRtsoNpx3f/jleoC/vDvXjAznfO497YTf/GgSM2\nLCnVtpPQQ2vQbOfTjaBYO2MpibQlYpbkbjkd5ZcO5U5PGrQpPFrWcylz7eUC3c05\nUVeygGIthsA/0hMCioYz4UjWTgi9NQLbhVkfmVQ5lCVxTotyBzoubh3FBz+wq2Qt\niElsBrCMR7UwmIu79UYzmLGt3/gBdHxaImrT9SQ8uqzP5eit54LlGbvGekVdAL5l\nDFwPcSB1IKauXZvi1DwFGPeemcSAndy+Uoqw5XGRqE6jBxS7XVI7/4BSMDDRBz1u\na+JMGZXS8yyYT+7HdsybfsZLvkVmc9zVSDI7/MjVPdk6h0sLn+vuPC1bIi5edoNy\nPdiG2uPH5eDO6INcisyPpLS4yFKliaO4Jjap7yzLU9pbItoWgCAYa2NpxuxHJ0tB\n7tlDFnvaRnQukqSG+VqNWg==\n-----END CERTIFICATE-----"

func InitCert() {
	initFile(config.GetConfig().DataDir+"/.license_decryption_key.pri", gitlabPrivateKey)
	initFile(config.GetConfig().DataDir+"/.license_encryption_key.pub", gitlabPublicKey)
	initFile(config.GetConfig().DataDir+"/jetbrainsCodeCACert.pem", jetbrainsCodeCa)
	initFile(config.GetConfig().DataDir+"/jetbrainsServerCACert.pem", jetbrainsServerCa)
}

// initFile 初始化文件
func initFile(filePath, content string) {
	// 判断文件是否存在
	if _, err := os.Stat(filePath); os.IsNotExist(err) {
		// 文件不存在，写入字符串到文件
		err = os.WriteFile(filePath, []byte(content), 0644)
		if err != nil {
			logger.Error("写入文件失败: %v", err)
		} else {
			logger.Info(fmt.Sprintf("文件写入成功, %s", filePath))
		}
	}
}
